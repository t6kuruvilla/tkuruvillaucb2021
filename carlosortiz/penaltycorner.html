<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
	<title>Scrollama: Sticky Side Example</title>
	<meta name="description" content="Scrollama: Sticky Side Example" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdn.jsdelivr.net/npm/vega@5.21.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.2.0"></script>
  <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.20.2"></script>

  <style media="screen">
    /* Add space between Vega-Embed links  */
    .vega-actions a {
      margin-right: 5px;
    }
  </style>

	<link rel="stylesheet" href="./style.css" />
	<style>
		#scrolly {
			position: relative;
			display: -webkit-box;
			display: -ms-flexbox;
			display: flex;
			background-color: #f3f3f3;
			padding: 1rem;
		}

		#scrolly>* {
			-webkit-box-flex: 1;
			-ms-flex: 1;
			flex: 1;
		}

		article {
			position: relative;
			padding: 0 1rem;
			max-width: 20rem;
		}

		figure {
			position: -webkit-sticky;
			position: sticky;
			width: 100%;
			margin: 0;
			-webkit-transform: translate3d(0, 0, 0);
			-moz-transform: translate3d(0, 0, 0);
			transform: translate3d(0, 0, 0);
			background-color: #8a8a8a;
			z-index: 0;
		}

		figure p {
			text-align: center;
			padding: 1rem;
			position: absolute;
			top: 50%;
			left: 50%;
			-moz-transform: translate(-50%, -50%);
			-webkit-transform: translate(-50%, -50%);
			transform: translate(-50%, -50%);
			font-size: 8rem;
			font-weight: 900;
			color: #fff;
		}

		.step {
			margin: 0 auto 2rem auto;
			background-color: #000000;
			color: #fff;
		}

		.step:last-child {
			margin-bottom: 0;
		}

		.step.is-active {
			background-color: rgb(255, 255, 255);
			color: #3b3b3b;
		}

		.step p {
			text-align: center;
			padding: 1rem;
			font-size: 1rem;
		}
	</style>
</head>

<body>
	<main>
		<section id="intro">
			<h1 class="intro__hed">The Penalty Shootout Corner</h1>
			<p class="intro__dek">
				<br>
				<h3>A quick intro: What is this all about?</h3>
				<br>
Welcome to the Penalty Kick Corner. In 2012, The Economist wrote an articled titled "Penalty shoot-outs are basically still crap-shoots". The article presents data and insights that point to what the Economist considered a conslusive insight that penalty shootouts are chance events. This site will let you lay rest to this question and make up your own mind based on data. In 10 minutes and a few clicks we expect you to have a data driven conclussion on whether penalty shootouts are chance events or not. Please follow the steps and instructions bellow to participate.
<br><br>
<h3>Step 1: Select your ELITE TEAMS</h3>
<br>
To answer this question, we'll begin with an assumption: if penalty shootouts are in fact a chance event, then we should not be able to see significant differences in performance between elite and non-elite teams would we? If elite teams are performing better on penalty shootouts, wouldn't that mean that penalty shootouts are not chance events, and that the skill, mental clarity and stress management that comes with being elite improves your chances of success? We don't want to bias you on what consititutes an elite team. It's entirely your call. Choose on the drop down menu between eight and 10 teams that you consider elite. Make sure that the ~8 to 10 teams you choose are what you personally consider the best amongst the list of all teams available. Everything you don't choose will be sent to the NON-ELITE team list. The data visualizations bellow will bot show until you have between 8 and 10 teams selected. Presenting the information before you make your selection, could bias your selection!
			</p>
			<br>		

			<fieldset>
			  <legend>&nbsp&nbspChoose your ELITE countries:&nbsp&nbsp</legend>  
			  <table style="width:100%">
				<tr>
					<td>
						<input type="checkbox" name="country_list" value="ARG">Argentina<br>     
						<input type="checkbox" name="country_list" value="BRA">Brazil<br>     
						<input type="checkbox" name="country_list" value="BUL">Bulgaria<br>
						<input type="checkbox" name="country_list" value="CRA">Canada<br>
						<input type="checkbox" name="country_list" value="CHI">Chile<br>
						<input type="checkbox" name="country_list" value="COL">Colombia<br>
						<input type="checkbox" name="country_list" value="CRO">Croatia<br>
					</td>
					<td>
						<input type="checkbox" name="country_list" value="DEN">Denmark<br>     
						<input type="checkbox" name="country_list" value="ENG">England<br>     
						<input type="checkbox" name="country_list" value="FRA">France<br>
						<input type="checkbox" name="country_list" value="GER">Germany<br>
						<input type="checkbox" name="country_list" value="GHA">Ghana<br>     
						<input type="checkbox" name="country_list" value="GRE">Greece<br>
						<input type="checkbox" name="country_list" value="HOL">Holland<br>
					</td>
					<td>
						<input type="checkbox" name="country_list" value="RUM">Hungary<br>
						<input type="checkbox" name="country_list" value="IRE">Ireland<br>     
						<input type="checkbox" name="country_list" value="ITA">Italy<br>     
						<input type="checkbox" name="country_list" value="JAP">Japan<br>
						<input type="checkbox" name="country_list" value="MEX">Mexico<br>
						<input type="checkbox" name="country_list" value="POR">Portugal<br>
						<input type="checkbox" name="country_list" value="ROM">Romania<br>
					</td>
					<td>						
						<input type="checkbox" name="country_list" value="RUS">Russia<br>     
						<input type="checkbox" name="country_list" value="SPA">Spain<br>     
						<input type="checkbox" name="country_list" value="SWE">Sweden<br>
						<input type="checkbox" name="country_list" value="SWZ">Switzerland<br>
						<input type="checkbox" name="country_list" value="UKR">Ukraine<br>     
						<input type="checkbox" name="country_list" value="URU">Uruguay<br>
						<input type="checkbox" name="country_list" value="YUG">Yugoslavia<br>
					</td>
			    </tr>
			  </table>			  
			     
			  <br>
			</fieldset>

		</section>

		<section id="scrolly">
			<article>
				<div class="step" data-step="1">
					<p><b>Welcome to the Penalty Kick Corner</b>
						<br><br> 
						In 2012, The Economist wrote an articled titled "Penalty shoot-outs are basically still crap-shoots". 
						The article presents data and insights that point to what the Economist considered a conslusive insight that penalty shootouts are chance events. 
						This site will let you lay rest to this question and make up your own mind based on data. 
						In 10 minutes and a few clicks we expect you to have a data driven conclussion on whether penalty shootouts are chance events or not. 
						Please follow the steps and instructions bellow to participate.
					</p>
				</div>
				<div class="step" data-step="2">
					<p>STEP 2</p>
				</div>
				<div class="step" data-step="3">
					<p>STEP 3</p>
				</div>
				<div class="step" data-step="4">
					<p>STEP 4</p>
				</div>
			</article>

			<figure>
				<div id="vis"></div>
			</figure>
		</section>

		<section id="outro"></section>
	</main>

	<!-- <div class='debug'></div> -->
	<script src="https://unpkg.com/d3@5.9.1/dist/d3.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
	<script src="./scrollama.min.js"></script>
	<script>
		// using d3 for convenience
		var main = d3.select("main");
		var scrolly = main.select("#scrolly");
		var figure = scrolly.select("figure");
		var article = scrolly.select("article");
		var step = article.selectAll(".step");

		// initialize the scrollama
		var scroller = scrollama();

		// generic window resize listener event
		function handleResize() {
			// 1. update height of step elements
			var stepH = Math.floor(window.innerHeight * 0.75);
			step.style("height", stepH + "px");

			var figureHeight = window.innerHeight / 2;
			var figureMarginTop = (window.innerHeight - figureHeight) / 2;

			figure
				.style("height", figureHeight + "px")
				.style("top", figureMarginTop + "px");

			// 3. tell scrollama to update new element dimensions
			scroller.resize();
		}

		// scrollama event handlers
		function handleStepEnter(response) {
			console.log(response);
			// response = { element, direction, index }

			// add color to current step only
			step.classed("is-active", function (d, i) {
				return i === response.index;
			});

			// update graphic based on step
      chart = getChart(response.index + 1)
			figure.select("div").html(chart);
		}
		
		function init() {

			// 1. force a resize on load to ensure proper dimensions are sent to scrollama
			handleResize();

			// 2. setup the scroller passing options
			// 		this will also initialize trigger observations
			// 3. bind scrollama event handlers (this can be chained like below)
			scroller
				.setup({
					step: "#scrolly article .step",
					offset: 0.33,
					debug: false
				})
				.onStepEnter(handleStepEnter);
		}

    function getChart(index) {

	  countries = selectedCountries()

      switch (index) {
        case 1:
          return vegaEmbed('#vis', chart1(countries));
        case 2:
		  return vegaEmbed('#vis', chart2(countries));
        case 3:
		  return vegaEmbed('#vis', chart3(countries));
        case 4:
		  return vegaEmbed('#vis', chart4(countries));
      }
    }

	function selectedCountries(){

		var countries = document.getElementsByName("country_list")

		selected_countries = []

		for(var i =0; i < countries.length; i++) {

			if (countries[i].checked) 			
				selected_countries.push(countries[i].value)

		}

		console.log(selected_countries)

		return(selected_countries)
	}

    function chart1(countries) {

	  var dataB = Papa.parse('penaltyNumber.csv');

	  console.log(dataB)
	  dataB.filter(Team => countries.indexOf(countries.Team) !== -1)

      return {
        $schema: 'https://vega.github.io/schema/vega-lite/v5.json',
		"width": 600,
        "height": 455,
        data: {
          values: [
            {a: 'A', b: 4},
            {a: 'A', b: 0},
            {a: 'A', b: 0},
            {a: 'B', b: 4},
            {a: 'B', b: 3},
            {a: 'B', b: 1},
            {a: 'C', b: 5},
            {a: 'C', b: 7},
            {a: 'C', b: 1}
          ]
        },
        mark: 'point',
        encoding: {
          y: {field: 'a', type: 'nominal'},
          x: {
            aggregate: 'average',
            field: 'b',
            type: 'quantitative',
            axis: {
              title: 'Average of b'
            }
          }
        }
      };
    }

	function chart2(countries) {
      console.log(countries)
      return {
        $schema: 'https://vega.github.io/schema/vega-lite/v5.json',
		"width": 600,
        "height": 455,
        data: {
          values: [
            {a: 'C', b: 8},
            {a: 'C', b: 3},
            {a: 'C', b: 4},
            {a: 'D', b: 7},
            {a: 'D', b: 3},
            {a: 'D', b: 9},
            {a: 'E', b: 5},
            {a: 'E', b: 2},
            {a: 'E', b: 9}
          ]
        },
        mark: 'bar',
        encoding: {
          y: {field: 'a', type: 'nominal'},
          x: {
            aggregate: 'average',
            field: 'b',
            type: 'quantitative',
            axis: {
              title: 'Average of b'
            }
          }
        }
      };
    }

    function chart3(countries) {
      console.log(countries)
      return {
        $schema: 'https://vega.github.io/schema/vega-lite/v5.json',
		"width": 600,
        "height": 455,
        data: {
          values: [
            {a: 'C', b: 5},
            {a: 'C', b: 6},
            {a: 'C', b: 7},
            {a: 'D', b: 6},
            {a: 'D', b: 5},
            {a: 'D', b: 6},
            {a: 'E', b: 7},
            {a: 'E', b: 5},
            {a: 'E', b: 7}
          ]
        },
        mark: 'line',
        encoding: {
          y: {field: 'a', type: 'nominal'},
          x: {
            aggregate: 'average',
            field: 'b',
            type: 'quantitative',
            axis: {
              title: 'Average of b'
            }
          }
        }
      };
    }

	function chart4(countries) {
      console.log(countries)
      return {
        $schema: 'https://vega.github.io/schema/vega-lite/v5.json',
		"width": 600,
        "height": 455,
        data: {
          values: [
            {a: 'C', b: 9},
            {a: 'C', b: 8},
            {a: 'C', b: 7},
            {a: 'D', b: 8},
            {a: 'D', b: 8},
            {a: 'D', b: 9},
            {a: 'E', b: 8},
            {a: 'E', b: 9},
            {a: 'E', b: 8}
          ]
        },
        mark: 'circle',
        encoding: {
          y: {field: 'a', type: 'nominal'},
          x: {
            aggregate: 'average',
            field: 'b',
            type: 'quantitative',
            axis: {
              title: 'Average of b'
            }
          }
        }
      };
    }

		// kick things off
		init();
	</script>
</body>

</html>
